this is old code copied over from phosphophyllite, should probably eventually make its way to do the cinnabar package
for now, this is fine